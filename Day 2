Cơ chế hoạt động của BlockChain

Dữ liệu được phân phối như thế nào?
Sử dụng sổ cái phân tán - công nghệ blockchain, giúp ta bỏ qua việc thiết lập đơn vị trung tâm. Bên cạnh đó, mỗi bên tham gia được đại diện bởi một nút blockchain sẽ có một bản sao của sổ cái để họ có thể tự kiểm tra và tích hợp với hệ thống của họ. Tuy nhiên, không yêu cầu mỗi đơn vị phải có một nút riêng. Các nút trong mạng có thể được chia sẻ giữa các đối tác.
Lưu ý : Mỗi nút được kết nối với các nút mạng blockchain

Thay đổi trạng thái
Dữ liệu ở trong một blockchain đại diện cho trạng thái.

Ví dụ 1: Đồng xu nằm trong túi của bạn, trạng thái sở hữu là của bạn. Nếu bạn đưa đồng xu cho bạn bè mình , trạng thái thay đổi thành người bạn đó sở hữu đồng xu.
Ví dụ 2: Chuyến hàng di chuyển qua chuỗi cung ứng. Trách nhiệm đối với sản phẩm ohair được chuyển giao. Dữ liệu mà chúng ta quan tâm là bên chiệu trách nhiệm, nhiệt độ và sản phẩm có được bảo quản tốt hay không?

Blockchain sử dụng các giao dịch – transaction, để thay đổi trạng thái của dữ liệu từ giá trị này qua giá trị khác. 
Ví dụ 3: Chúng ta cần biết liệu hàng hóa có được bảo quản ở mức tiêu chuẩn hay không. Trong lô hàng, một cảm biến nhiệt độ sẽ báo nhiệt độ theo định kì. Nhiệt độ được báo cáo được coi là một giao dịch, và được gửi đến một nút giao dịch blockchain.

Quy trình hoạt động:
Mỗi khi lô hàng qua chuỗi cung ứng, một giao dịch sẽ được gửi mỗi khi trạng thái thay đổi.
Khi gửi một giao dịch, bạn sẽ gửi nó đến một nút giao dịch BlockChain 
BlockChain gửi các giao dịch lên toàn mạng. Mỗi nút sẽ nhận được một bản sao của giao dịch
Mỗi nút sau đó xử lý giao dịch nhưng vẫn yêu cầu bằng cơ chế đồng thuận. Sự đồng thuận tạo ra sự nhất quán và tin cậy cho sổ cái phân tán

Làm thế nào mà bạn có thể tin tưởng tính nhất quán trong dữ liệu sổ cái?
BlockChain sử dụng cơ chế đồng thuận để xác nhận dữ liệu trên tất cả các nút. Sử dụng sự đồng thuận giúp các nút phi tập trung đến cùng một trạng thái. Khi chuyển giao giá trị hoặc trách nhiệm, hoặc các vấn đề liên quan tới đặt hàng.

Ví dụ: Nếu bản chuyển quyền sở hữu xe của bạn cho một người bạn, bạn sẽ không thể chuyển quyền sở hữu chiếc xe ấy cho một người khác.

Vấn đề này được gọi là lặp chi – double spending, mà sự đồng thuận có thể giải quyết. 
Sự đồng thuận đảm bảo thứ tự chính xác của các giao dịch và tính toàn vẹn trên hệ thống blockchain.
Dễ hình dung trong quá trình đi đến sự đồng thuận, một nhóm giao dịch được xác thực dưới dạng mã khối và mạng lưới phải đồng ý xem khối đó có nên được đưa vào blockchain hay không.

Khối là gì?

Một khối, hay một block, là một cụm dữ liệu trong chuỗi khối – blockchain, lưu trữ thông tin giao dịch. 
Số lượng giao dịch trong một khối thường dựa trên thời gian. 
Ví dụ, hình minh họa cho thấy một khối chứa các giao dịch đã xảy ra trong 10p.

Thông qua sự đồng thuận, các khối đã xác thực được thêm vào blockchain tại các nút. 
Bởi vì tất cả các nút có các khối giống nhau trong chuỗi, sổ cái nhất quán trên toàn mạng. 
Kết quả là tất cả các nút đều chứa cùng một dữ liệu đã được xác định theo thứ tự đã thỏa thuận.


Làm thế nào để bạn tin tưởng sổ cái không bị thay đổi?

Blockchain sử dụng một hàm băm mật mã để tạo liên kết giữa các khối. 
Bằng cách liên kết các khối, thứ tự giao dịch có thể được thỏa thuận thông qua thuật toán đồng thuận. 
Hàm băm mật mã là một thuật toán án xạ dữ liệu có kích thước tùy ý sang biểu diễn bit có kích thước cố định. 
Bạn có thể liên tưởng tới chữ kí số. Bitcoin sử dụng thuật toán băm SHA-256. 
Nếu bạn đã sử dụng hàm băm SHA-256 trên tài liệu 100 trang, đầu ra của hàm là giá trị băm 256 bit. 
Trong trường hợp bạn thay đổi dù chỉ một ký tự trong tài liệu và tạo lại hàm băm, thì kết quả đầu ra thu được là một giá trị 256-bit hoàn toàn khác. 
Ví dụ : Tưởng tượng nếu chúng ta sử dụng một khối làm đầu vào cho hàm băm. Đầu ra sẽ là một giá trị băm duy nhất cho dữ liệu trong khối.
  -Blockchain sử dụng các hàm băm để phát hiện xem có bất kì thay đổi nào được thực hiện đối với các khối hay không. 
Bằng cách bao gồm giá trị băm của khối trước vào quá trình tạo hàm băm của khối tiếp theo, các khối được liên kết với nhau thông qua các hàm băm.
  -Blockchain cung cấp sự tin tưởng bằng cách sử dụng hàm băm để chứng minh lịch sử dữ liệu không thay đổi. 
Và bằng cách bao gồm hàm băm của khối trước vào việc tạo khối mới, một chuỗi giao dịch bất biến được tạo theo thứ tự.
  -Nếu bất kì khối nào được sửa đổi trong chuỗi, hàm băm của các khối sau đó sẽ khác. 
Kết quả là quá trình xác thực phát hiện ra sự khác biệt.

Logic tin cậy

Sử dụng logic để chuyển trách nhiệm của đơn vị phụ trách sản phẩm từ người này sang người khác. Ngoài ra, ta cũng cần sử dụng dữ liệu từ cảm biến nhiệt độ để xác định được trạng thái bảo quản sản phẩm.

Ứng dụng phi tập trung (DApp) là một ứng dụng trên hệ thống máy tính phân tán. Chúng ta sẽ tập trung vào việc sử dụng giao thức Ethereum (Ethereum DApps được gọi là các hợp đồng thông minh – smart contract). 
Hợp đồng thông minh chứa logic được thực hiện như một phần của giao dịch. 
Trên nền tảng Ethereum, bạn đọc sẽ lập trình logic bằng ngôn ngữ Solidity.

Các hợp đồng thông minh được triển khai vào Blockchain và được tham chiếu bởi một địa chỉ. 
Để sử dụng hợp đồng thông minh, bạn tạo một thực thể - instance (Instance hợp đồng thông mình chứa dữ liệu trạng thái và logic chương trình)
Trong kịch bản của chúng ta, một instance hợp đồng thông minh chứa dữ liệu như: đơn vị chịu trách nhiệm cho khâu cụ thể, vị trí và tình huống nhiệt độ bảo quản bị sai lệc

Cũng giống như dữ liệu trong blockchain, hợp đồng thông minh không thể thay đổi. Một khi đã được triển khai thì không thể thay đổi logic. 
Do đó, bạn có thể tin tưởng rằng logic hợp đồng thông minh luôn thực thi giống nhau trên mọi nút. 
Bất kỳ thay đổi nào cũng yêu cầu một hợp đồng thông minh mới được triển khai tại một địa chỉ mới.










